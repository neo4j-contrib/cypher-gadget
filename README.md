versal-cypher-gadget
====================

This is the standalone version of the versal course gadget for Cypher problem solving.

There is no build process, just `coffee -c .` from the root directory to compile from coffeescript and publish.
See `test.html` for a working version of the widget.
You can configure the widget via the url. 
For example `/test.html?cypherSetup=full&cypherTask=matchByNodeLabel` uses the database called `full` and the task `matchByNodeLabel`. 

Tasks
========

You can create tasks by adding them to `data/tasks.coffee` and republishing the gadget. 

Here is an example task blob:


`{
  message: "Lab: Find the 5 busiest actors in this dataset, use what you've learned",
  tasks: [
    {
      "check": "input",
      "test": ":ACTED_IN",
      "failMsg": "Your paths should use the ACTED_IN relationship"
    },
    {
      "check": "output",
      "results": "Gene Hackman",
      "failMsg": "We expected someone else."
    }
  ]
}`

There are two types of task checks, "input" and "output".
Input checks the query text as a case-insensitive regex) before it's sent.
Output check the response from the server in **only one** of two ways, either by checking the query response with "results" or by checking the entire graph with "test."

For example:

`{
  "message": "Create a node named 'Keanu Reeves'",
  "tasks": [
    {
      "check": "output",
      "results": "Keanu Reeves",
      "failMsg": "FAIL"
    }
  ]
}`

will fail with `CREATE {name:"Keanu"}` because "results" checks the response that populates the gadget's query response table.
`CREATE (m {name:"Keanu"}) RETURN m` will succeed, however.
As well, instead of "results", `"test": "Keanu Reeves"` in the json above will succeed because now it's checking against the whole graph.

Each input task will be checked in order, then each output task in order - if a task fails it will display the failMsg and **not** check subsequent tasks, so one error shows at a time.

The order of precedence for errors is:

- Syntax (generated by backed)
- Input
- Output "results" (check query response)
- Output "test" (check graph after query)
